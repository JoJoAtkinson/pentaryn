# D&D Session 1 Configuration

[session]

# Recording source affects speaker identification reliability
# Options: "in-person" (single mic), "discord" (separate recordings), "hybrid"
recording_source = "in-person"

# Speaker identification notes (helps LLM understand speaker labels)
[session.speakers]
# Reliable identifications
NICOLE = "Sabriel (player character)"
KRIS = "Marwen (player character)"
JEFF = "Bazgar (player character)"
JOE = "Dungeon Master (DM)"

# Additional context
notes = """
- each player has their own recording; so speaker identification is absolutely correct.
"""

[context]
# Upfront context files (relative to repo root)
files = [
    "world/factions/ardenhaven/locations/ardenford/ardenford.md",
    "world/factions/ardenhaven/locations/ardenford/ardernford.story.md",
]

# Folders to auto-include (all .md files)
folders = [
    "world/factions/ardenhaven/npc",
    "world/factions/ardenhaven/quests",
]

[pass1]
output = "pass1.json"
batch_size = 1000
overlap = 250
model = "gpt-5.2"

[pass2]
output = "pass2"
model = "gpt-5.2"
# Seconds of transcript context before/after each scene
context_before = 30.0
context_after = 30.0
# Maximum line length for text wrapping in TOML output
max_line_length = 100

[summary]
model = "gpt-5.2"
temperature = 0.7
prompts = ["bardic-dm", "elric-chronicler"]

[pass3]
# CRITICAL: output MUST point to story/the-compass-edge
# This is a git submodule/repo used for publishing player-facing story content.
# Do NOT change this path without understanding the git submodule structure.
# Write player-facing story output into the story submodule (keeps access control separate)
output = "story/the-compass-edge"
model = "gpt-5.2"
temperature = 0.7  # Higher for creative prose (0.0-2.0)

# Chapter numbering + filenames:
# - Files are written as: 0010-chapter-title.md (numeric prefix leaves insertion room).
chapter_number_width = 4
chapter_number_step = 10
chapter_number_start = 10

# File-splitting algorithm parameters
max_scenes_per_file = 5  # Readability limit
time_jump_threshold_seconds = 3600  # 1 hour = chapter break

# Narrative time phrases that trigger chapter breaks
time_jump_phrases = [
    "next day",
    "next morning",
    "the following day",
    "hours later",
    "long rest",
]

# Tone transitions that suggest chapter breaks
tone_break_transitions = [
    ["combat", "casual"],
    ["tense", "casual"],
    ["somber", "casual"],
]

# POV characters for rotating third-person limited perspective
pov_characters = ["Bazgar", "Sabriel", "Marwen"]

# Character voice is sourced from PC narrative files under `characters/player-characters/*.narrative.md`.
# Avoid duplicating voice notes here to prevent drift.

[timeline]
# Party name (maps to world/party/{party_name}/_history.tsv)
party_name = "the-compass-edge"

# Event ID prefix for timeline events
event_id_prefix = "party-compass"

# LLM model for generating summaries (optional; if not specified, uses algorithmic summaries)
model = "gpt-5.2"
temperature = 0.3  # Lower for factual timeline summaries

# Maximum events per day (10,000 foot view)
max_events_per_day = 3

# Phrases that indicate a new day has started
new_day_indicators = [
    "next day",
    "next morning",
    "following day",
    "the following day",
    "dawn",
    "sunrise",
    "long rest",
    "after resting",
]

# Priority scoring for event importance (higher = more important)
[timeline.priority_keywords]
combat = 10
boss = 10
death = 9
betrayal = 9
revelation = 8
discovery = 7
quest = 6
npc = 5
travel = 3
shopping = 2
rest = 1
